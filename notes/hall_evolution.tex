\documentclass[letterpaper,10pt]{article}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{listings}
\usepackage{float}
\usepackage{natbib}
\bibliographystyle{plainnat}

\newcommand{\dd}{\,\mathrm{d}\,}
\newcommand{\pp}{\partial}
\newcommand{\co}{\mathrm{.}}
\newcommand{\cosec}{\mathrm{cosec}}
\newcommand{\cotan}{\mathrm{cotan}}
\newcommand{\D}{\displaystyle}

\renewcommand{\vec}[1]{\boldsymbol#1}
\newcommand{\bhat}[1]{\hat{\boldsymbol#1}}

\setlength\topmargin{0.5in}
\setlength\headheight{0in}
\setlength\headsep{0in}
\setlength\textheight{9in}
\setlength\textwidth{6.5in}
\setlength\oddsidemargin{0in}
\setlength\evensidemargin{0in}
\setlength\parindent{0.25in}
\setlength\parskip{0.25in}

%opening
\title{Hall Evolution}
\author{Pablo Marchant Campos}
\begin{document}
\maketitle
I will consider a magnetic field that evolves according to the eq.
\begin{eqnarray}
\frac{\dd \vec{B}}{\dd t}=-\nabla\times\left(\frac{c}{4\pi ne}[\nabla\times\vec{B}]\times\vec{B}+\eta\nabla\times\vec{B}\right),\label{intro::timeeq}
\end{eqnarray}
where $n$ is the electron density and $\eta\equiv c^2/(4\pi\sigma)$ (where $\sigma$ is the electrical conductivity) is the magnetic diffusivity. For simplicity i will consider both of these quantities to be radial functions, and time independent.

Restricting this to an axisymmetric field, $\vec{B}$ can be written in terms of two scalar functions as
\begin{eqnarray}
\vec{B}=\nabla\alpha(r,\theta)\times\nabla\phi+\beta\nabla\phi,
\end{eqnarray}
where $\phi$ is the azimuth in spherical coordinates. Thus, $\alpha(r,\theta)$ describes the poloidal field and $\beta(r,\theta)$ the toroidal field. The curl of $\vec{B}$ can be expressed in terms of these functions,
\begin{eqnarray}
\nabla\times\vec{B}=-\Delta\alpha\nabla\phi+\nabla \beta\times\nabla\phi.,\quad \Delta\equiv=\varpi^2\nabla\cdot(\varpi^{-2}\nabla)=\pp_r^2+\frac{\sin\theta}{r^2}\pp_\theta\left(\frac{\pp_\theta}{\sin\theta}\right)
\end{eqnarray}
Using this, and defining $\chi\equiv c/(4\pi en\varpi^2)$, where $\varpi\equiv r\sin\theta$ is the radial coordinate, eq. (\ref{intro::timeeq}) gives
\begin{eqnarray}
\nabla\left(\frac{\pp \alpha}{\pp t}\right)\times\nabla\phi+\frac{\pp\beta}{\pp t}\nabla\phi=
\nabla\times\left(\varpi^2\chi[\Delta\alpha\nabla\phi-\nabla\beta\times\nabla\phi]\times[\nabla\alpha\times\nabla\phi+\beta\nabla\phi]-\eta[-\Delta\alpha\nabla\phi+\nabla\beta\times\nabla\phi]\right).
\end{eqnarray}
After expanding the cross product inside the curl, each term in this equation is either poloidal or toroidal, and taking this into account, i write two equations which together are equivalent to the previous one,
\begin{eqnarray}
\begin{aligned}
\nabla\left(\frac{\pp \alpha}{\pp t}\right)\times\nabla\phi=&
\nabla\times\left(\varpi^2\chi[\nabla\beta\times\nabla\phi]\times[\nabla\alpha\times\nabla\phi]+\eta\Delta\alpha\nabla\phi\right),\\
\frac{\pp\beta}{\pp t}\nabla\phi=&
\nabla\times\left(\varpi^2\chi\Delta\alpha\nabla\phi\times[\nabla\alpha\times\nabla\phi]+\varpi^2\chi\beta\nabla\phi\times[\nabla\beta\times\nabla\phi]-\eta\nabla\beta\times\nabla\phi\right).
\end{aligned}
\end{eqnarray}
With a couple of changes, these equations can be transformed into equations for the scalar functions $\alpha$ and $\beta$,
\begin{eqnarray}
\begin{aligned}
\frac{\pp\alpha}{\pp t}=&\varpi^2\chi[\nabla\alpha\times\nabla\beta]\cdot\nabla\phi+\eta\Delta\alpha\\
\frac{\pp \beta}{\pp t}=&\varpi^2(\nabla[\chi\Delta\alpha]\times\nabla\alpha+\beta\nabla\chi\times\nabla\beta)\cdot\nabla\phi+\varpi^2\nabla\cdot\left(\frac{\eta\nabla\beta}{\varpi^2}\right).
\end{aligned}
\end{eqnarray}
I will consider an adimensional form of this equation, in which each quantity is expressed in terms of characteristic values $B_0$ for the magnetic field, $n_0$ for $n$ and the radius of the star $R$ for the radial coordinate $r$. These characteristic values define two timescales
\begin{eqnarray}
t_h\equiv\frac{4\pi ne R^2}{cB_0},\quad t_d\equiv\frac{R^2}{\eta}
\end{eqnarray}
and if I consider my unit of time to be $t_h$, the equations for $\alpha$ and $\beta$ (considering all the quantities in their adimensional versions) are given by
\begin{eqnarray}
\begin{aligned}
\frac{\pp\alpha}{\pp t}=&\varpi^2\chi[\nabla\alpha\times\nabla\beta]\cdot\nabla\phi+\left(\frac{t_h}{t_d}\right)\eta\Delta\alpha\\
\frac{\pp \beta}{\pp t}=&\varpi^2(\nabla[\chi\Delta\alpha]\times\nabla\alpha+\beta\nabla\chi\times\nabla\beta)\cdot\nabla\phi+\left(\frac{t_h}{t_d}\right)\varpi^2\nabla\cdot\left(\frac{\eta\nabla\beta}{\varpi^2}\right),
\end{aligned}\label{intro::eqs}
\end{eqnarray}
where the adimensional $\chi$ is given by $\chi=1/(\varpi^2 n)$, with $\varpi$ and $n$ in their adimensional versions of course.
\section{Toroidal Field}
To begin, I will consider a toroidal field. It is clear from eq. (\ref{intro::eqs}) that a purely toroidal field will remain toroidal. Although in this section I take $\alpha=0$, I will show first that the eq. for $\beta$ in (\ref{intro::eqs}) can be written as a conservative eq.,
\begin{eqnarray}
\frac{1}{\varpi^2}\frac{\pp\beta}{\pp t}=&\nabla\times(\chi\Delta\alpha\nabla\alpha+\chi\beta\nabla\beta)\cdot\phi+\left(\frac{t_h}{t_d}\right)\nabla\cdot\left(\frac{\eta\nabla\beta}{\varpi^2}\right)\\
\frac{1}{\varpi^2}\frac{\pp\beta}{\pp t}=&\nabla\cdot(\nabla\phi\times[\chi\Delta\alpha\nabla\alpha+\chi\beta\nabla\beta])+\left(\frac{t_h}{t_d}\right)\nabla\cdot\left(\frac{\eta\nabla\beta}{\varpi^2}\right),\label{tor::cons}
\end{eqnarray}
so I expect the quantity
\begin{eqnarray}
I_1=\int_V\frac{\beta}{\varpi^2}\dd V
\end{eqnarray}
to remain constant unless the "fluxes" in eq. (\ref{tor::cons}) are not zero in the boundaries. Since $\beta/\varpi=B_{tor}$, where $B_{tor}$ is the toroidal component of the magnetic field, $I_1$ can also be written as
\begin{eqnarray}
I_1=2\pi\int_0^\pi\int_0^R B_{tor}r\dd r\dd\theta,
\end{eqnarray}
which is simply the magnetic flux that crosses a half cut of the star that crosses the symmetry axis. So, when considering the evolution of the system under axial symmetry, the toroidal flux is a conserved quantity.

Now, let us consider the case $\alpha=0$. Expressing eq. (\ref{tor::cons}) in terms of spherical coordinates gives
\begin{eqnarray}
\frac{\pp}{\pp t}\left(\frac{\beta}{\varpi^2}\right)=\frac{1}{r^2} \frac{\pp}{\pp r}\left(\frac{\chi\beta}{\sin\theta}\frac{\pp \beta}{\pp\theta}+\left(\frac{t_h}{t_d}\right)\frac{\eta r^2}{\varpi^2}\frac{\pp\beta}{\pp r}\right)+\frac{1}{\varpi}\frac{\pp}{\pp\theta}\left(-\frac{\chi\beta}{r}\frac{\pp\beta}{\pp r}+\left(\frac{t_h}{t_d}\right)\frac{\sin\theta \eta}{r\varpi^2}\frac{\pp\beta}{\pp\theta}\right),
\end{eqnarray}
which after multiplication by $r^2\sin\theta$ gives an equation for which a conservative code can be readily constructed,
\begin{eqnarray}
\frac{\pp}{\pp t}\left(\frac{\beta}{\sin\theta}\right)=\frac{\pp}{\pp r}\left(\chi\beta\frac{\pp \beta}{\pp\theta}+\left(\frac{t_h}{t_d}\right)\frac{\eta}{\sin\theta}\frac{\pp\beta}{\pp r}\right)+\frac{\pp}{\pp\theta}\left(-\chi\beta\frac{\pp\beta}{\pp r}+\left(\frac{t_h}{t_d}\right)\frac{\eta}{r^2\sin\theta}\frac{\pp\beta}{\pp\theta}\right).\label{equbeta}
\end{eqnarray}
In order to perform the simulation, I will consider a discretization on a grid with spacing $\Delta r$ in the radial coordinate and $\Delta \theta$ in the angular coordinate, and a timestep $\Delta t$. In this way, I will have $\beta(r,\theta,t)\rightarrow \beta_{i,j}^n$, where the indexes $i,j,n$ represent steps in radius, angle and time. The conservative scheme will then be
\begin{eqnarray}
\begin{aligned}
\frac{\beta_{i,j}^{n+1}-\beta_{i,j}^{n}}{\Delta t\sin (j\Delta)\theta}=&\D\frac{1}{\Delta r}\left[\left(\chi\beta\frac{\pp \beta}{\pp\theta}+\left(\frac{t_h}{t_d}\right)\frac{\eta}{\sin\theta}\frac{\pp\beta}{\pp r}\right)_{i+1/2,j}-\left(\chi\beta\frac{\pp \beta}{\pp\theta}+\left(\frac{t_h}{t_d}\right)\frac{\eta}{\sin\theta}\frac{\pp\beta}{\pp r}\right)_{i-1/2,j}\right]\\
&\D+\frac{1}{\Delta\theta}\left[\left(-\chi\beta\frac{\pp\beta}{\pp r}+\left(\frac{t_h}{t_d}\right)\frac{\eta}{r^2\sin\theta}\frac{\pp\beta}{\pp\theta}\right)_{i,j+1/2}-\left(-\chi\beta\frac{\pp\beta}{\pp r}+\left(\frac{t_h}{t_d}\right)\frac{\eta}{r^2\sin\theta}\frac{\pp\beta}{\pp\theta}\right)_{i,j-1/2}\right].\label{equbetacons}
\end{aligned}
\end{eqnarray}

\section{Toroidal plus poloidal field}
A purely poloidal field, unless it is in precise equilibrium, will produce a toroidal component. Thus, it is not possible to treat the evolution of a purely poloidal field without including the toroidal component.

The modified form of eq. (\ref{equbeta}), including the effect of the poloidal field, is
\begin{eqnarray}
\frac{\pp}{\pp t}\left(\frac{\beta}{\sin\theta}\right)=\frac{\pp}{\pp r}\left(\chi\Delta\alpha\frac{\pp\alpha}{\pp\theta}+\chi\beta\frac{\pp \beta}{\pp\theta}+\left(\frac{t_h}{t_d}\right)\frac{\eta}{\sin\theta}\frac{\pp\beta}{\pp r}\right)+\frac{\pp}{\pp\theta}\left(-\chi\Delta\alpha\frac{\pp\alpha}{\pp r}-\chi\beta\frac{\pp\beta}{\pp r}+\left(\frac{t_h}{t_d}\right)\frac{\eta}{r^2\sin\theta}\frac{\pp\beta}{\pp\theta}\right),
\end{eqnarray}
for which a conservative scheme can be written just as was done in eq. (\ref{equbetacons}). However, the evaluation of the term $\Delta\alpha$ at midpoints of the grid is not a trivial affair, since it requires more than the neighbouring points to be solved. Since those extra points are not available for points right at the boundaries,  a special treatment is required there, which is explained in the following section.

The time evolution equation for $\alpha$ is given in spherical coordinates by
\begin{eqnarray}
\frac{\pp\alpha}{\pp t}=\sin\theta\chi\left(\frac{\pp\beta}{\pp\theta}\frac{\pp \alpha}{\pp r}-\frac{\pp\beta}{\pp r}\frac{\pp \alpha}{\pp \theta}\right)+\eta\Delta\alpha
\end{eqnarray}
\section{Boundary Conditions}
For our simulations I will consider the magnetic field to be confined inside a spherical shell (the crust of the neutron star) with an internal radius $r_{min}$. The interior of the star is (for now) considered to be a superconducting fluid which has completely expelled all its magnetic flux due to the Meisnner effect.
\subsection{Conditions at the axis $\theta=0,\pi$}
The only requirement at the axis is that the magnetic field is not a multi-valued function. This implies that $B_{phi}=B_{\theta}=0$, which in turn gives
\begin{eqnarray}
\beta(\theta=0,\pi)=0,\qquad \frac{\pp\alpha}{\pp r}(\theta=0,\pi)=0,
\end{eqnarray}
which means $\alpha$ is constant at the axis. Since $\alpha$ has an arbitrary "zero-point", I choose $\alpha=0$ at the axis.
\subsection{Conditions for $r=r_{min}$}
At the inner boundary, where I have the interface between the crust and the inner superconducting shell, I require the normal component of the magnetic field and the tangential component of the electric field to be continuous,
\begin{eqnarray}
[B_r]_{in}=[B_r]_{out},\qquad [E_{\theta}]_{in}=[E_{\theta}]_{out},\qquad [E_{\phi}]_{in}=[E_{\phi}]_{out},
\end{eqnarray}
However, I expect both the magnetic and the electric field to be zero inside the superconductor, so these conditions are simply
\begin{eqnarray}
B_r(r=r_{min})=0,\qquad E_{\theta}(r=r_{min})=0,\qquad E_{\phi}(r=r_{min})=0.
\end{eqnarray}
The easiest of these three to apply is the first one. Since $B_r\propto \pp\alpha/\pp\theta$, it implies that $\alpha$ is constant at the boundary, and since I already fixed $\alpha=0$ at the symmetry axis I must have $\alpha=0$ at  $r=r_{min}$ also.

The condition on the electric field produces a much more complex boundary condition. In terms of the magnetic field, the electric field in the crust is given by
\begin{eqnarray}
-c\vec{E}=\frac{c}{4\pi n e}(\nabla\times\vec{B})\times\vec{B}+\eta\nabla\times\vec{B},
\end{eqnarray}
so requiring the tangential component of the electric field to be zero at the boundary is equivalent to
\begin{eqnarray}
0=\left[(\nabla\times\vec{B})\times\vec{B}+(n\eta)\left(\frac{t_h}{t_d}\right)\nabla\times\vec{B}\right]_T,
\end{eqnarray}
where $T$ denotes the tangential component, and $n$ and $\eta$ are the adimensional electron density and resistivity. In terms of $\alpha$ and $\beta$ this produces the following two (non-linear) boundary conditions
\begin{eqnarray}
\begin{aligned}
0=&\frac{\beta}{r^2\sin\theta}\frac{\pp\beta}{\pp\theta}+(n\eta)\frac{t_h}{t_d}\frac{\pp\beta}{\pp r}\\
0=&\frac{1}{r^2\sin\theta}\frac{\pp\beta}{\pp\theta}\frac{\pp\alpha}{\pp r}+(n\eta)\frac{t_h}{t_d}\Delta\alpha
\end{aligned}
\end{eqnarray}
\subsection{Conditions for $r=R$}
If outside the star I consider a perfect vacuum, then the magnetic field there is completely determined by its radial component at the surface of the star, which must be continuous. Furthermore, I expect surface currents to dissipate in timescales much smaller than those of interest to us, so not only the radial component of the magnetic field must be continuous, but the tangential one also.

The condition imposed on $\beta$ because of this is trivial. Since there are no currents outside the star, I must have $\beta=0$ there, and the continuity of the azimuthal component of the field immediately gives $\beta=0$ as a boundary condition at $r=R$.

The condition on $\alpha$ is much more complex, as it is non-local. As shown in \citet{mar+11}, the continuity of the radial component of the magnetic field implies that the field outside the star is given by
\begin{eqnarray}
\vec{B}=\nabla\Psi,\quad \Psi(r,\theta,\phi)=\sum_{l=1}^{\infty}\sum_{m=-l}^{l}\frac{a_{lm}}{r^{l+1}}Y_{lm}(\theta,\phi),\quad a_{lm}=-\frac{R^{l+2}}{l+1}\int_{4\pi}Y_{lm}^*(B_r)_{r=R}\dd\Omega,
\end{eqnarray}
where $(B_r)_{r=R}$ is the radial field $\vec{B}\cdot\bhat{r}$ at the surface of the star, which can be expressed in terms of $\alpha$ by $([r^2\sin\theta]^{-1}\pp\alpha/\pp\theta)_{r=R}$. Under axial symmetry, only the coefficients with $m\neq0$ are non-zero, and for these cases, I have (omitting the unnecessary $m=0$ sub-index)
\begin{eqnarray}
a_l=-\frac{R^{l+2}}{l+1}\int_0^{2\pi}\dd\phi\int_0^{\pi} Y_{l,0}^*([r^2\sin\theta]^{-1}\pp\alpha/\pp\theta)_{r=R}\cdot \sin\theta\dd\theta=-\frac{R^l}{l+1}\sqrt{\frac{2l+1}{4\pi}}\cdot 2\pi \int_0^{\pi} P_l(\cos\theta)\frac{\pp\alpha}{\pp\theta} \dd\theta,
\end{eqnarray}
where I droped the notation $(r=R)$ for clarity. This can be solved using integration by parts to obtain an expression that only depends on $\alpha$. Boundary terms are zero, since I set $\alpha=0$ at the axis and the Legendre polynomials are non-singular, so I have
\begin{eqnarray}
a_l=\frac{R^l}{l+1}\sqrt{\pi(2l+1)}\int_0^{\pi}\frac{\pp P_l(\cos\theta)}{\pp \theta}\alpha\dd\theta=\frac{R^l}{l+1}\sqrt{\pi(2l+1)}\int_0^{\pi}-\sin\theta\frac{\pp P_l(\cos\theta)}{\pp \cos\theta}\alpha\dd\theta.
\end{eqnarray}
The derivative of the Legendre polynomial can be solved using the identity
\begin{eqnarray}
\frac{x^2-1}{l}\frac{\dd}{\dd x}P_l(x)=xP_l(x)-P_{n-1}(x),\label{identityLeg}
\end{eqnarray}
with which I get the expression for the $a_l$ I require,
\begin{eqnarray}
a_l=\frac{lR^l}{l+1}\sqrt{\pi(2l+1)}\int_0^{\pi}\frac{\alpha(\cos\theta P_l(\cos\theta)-P_{l-1}(\cos\theta))}{\sin\theta}\dd\theta.=\frac{lR^l}{l+1}\sqrt{\pi(2l+1)}A_l,
\end{eqnarray}
where $A_l$ stands for the integral. So far, I have not used that I need the tangential component of the magnetic field to be continuous through the surface. This will require the $r$ derivative of $\alpha$ to be continuous across the surface of the star. In order to use it, I first need to solve the value of $\alpha$ outside the star, given the values of the $a_l$. For $r>R$ I have that
\begin{eqnarray}
B_\theta=\sum_{l=1}^\infty\frac{a_l}{r^{l+2}}\sqrt{\frac{2l+1}{4\pi}}\frac{\pp}{\pp\theta}P_l(\cos\theta)=-\frac{1}{r\sin\theta}\frac{\pp\alpha}{\pp r},
\end{eqnarray}
and I can use eq. (\ref{identityLeg}), solve for $\pp\alpha/\pp r$, integrate and apply the condition $\alpha\rightarrow 0$ when $r\rightarrow\infty$ to obtain
\begin{eqnarray}
\alpha=\sum_{l=1}^{\infty}\frac{a_l}{r^l}\sqrt{\frac{2l+1}{4\pi}}(\cos\theta P_l(\cos\theta)-P_{l-1}(\cos\theta))=
\sum_{l=1}^{\infty}\left(\frac{R}{r}\right)^l\frac{l(2l+1)}{2(l+1)}A_l(\cos\theta P_l(\cos\theta)-P_{l-1}(\cos\theta)),\label{equalphabound}
\end{eqnarray}
so, if I am able to solve the values of the $A_l$, I could use this expression to obtain the value of $\alpha$ at a point just outside the star, and thus, the boundary condition would be met. However, for practical reasons, I cannot time-evolve $\alpha$ right at the surface\footnote{in realistic density profiles where $n_e\rightarrow0$ at the surface, I have that $\chi\rightarrow\infty$, making it impossible for a finite difference code to time-evolve that point.}, so what I actually do, is to solve the $A_l$ at $R-\Delta r$ instead of at $R$, and use eq. (\ref{equalphabound}) with $R$ replaced by $R-\Delta r$ to solve the value of $\alpha$ at $R$.
\section{Ohm Eigenmodes (constant $\eta$)}
If I consider the evolution of the magnetic field due purely to Ohm, with constant resistivity, then the time-evolution eqs. (\ref{intro::eqs}) are the same for both $\alpha$ and $\beta$,
\begin{eqnarray}
\frac{\pp\alpha}{\pp t}=\eta\Delta \alpha,\qquad \frac{\pp\beta}{\pp t}=\eta\Delta \beta,
\end{eqnarray}
where I have setted $(t_h/t_d)=1$, since Hall terms are irrelevant here.
\bibliography{biblio}

\end{document}









